def rsa_encrypt(msg,e,n): # encrypts an integer
    encryption = pow(msg, e, n)
    return encryption

def rsa_decrypt(enc,d,n): # decrypts an integer
    msg = pow(enc, d, n)
    return msg

def string_to_val(s = "hello"): # converts a string of characters to integers
    return int("".join(["{:07b}".format(ord(x)) for x in s]),2)
    
def val_to_string_natural(val = 28130883183): # converts integers to a string of characters
    s = []
    v = val
    while v > 0:
        s.append(v & 0b1111111)
        v = v >> 7
    s.reverse()
    g = [chr(x) for x in s]
    return "".join(g)

def rsa_encrypt_string(s,e,n):
    s = string_to_val(s)
    enc = rsa_encrypt(s,e,n)
    return enc
    print("Your private key is the following:\n" + str(enc))

def rsa_decrypt_string(enc,d,n):
    msg = rsa_decrypt(enc,d,n)
    message = val_to_string_natural(msg)
    print("Your secret message is the following:\n" + str(message))
    
def main():
    
    n = 39568504406304548681697550749179851657365736735980358660590176565443461546908231439706122401616836915600980166871706246395923234036586326453186783382387891357229750891791132165057365158193316678627184523989167752836025967546670232087099258922533791069246468684706176592422352659920320590892127762737367845066134270746020555206942642475680025394626671497210096584106779399497878232089330740358441378692551186422455137380976461327655103896917815013704081667482063673998043010313432513418734100277592883121016720993377404262178792095511981511011603570553471206807112018357167626975769414556830101935341974571974237596633
    e = 65537
    d = 7173251763909003202576385865251778652382048585687209381669467442422353275841382695807687874843365417920491407336355675624913620452396083808998156360012672798804441313233294799167593198414556593355960439591609351533405931312418771494374571543687138131036167271052902697629888031989766527921469855945231966175227559428077797448206046837887835074391910248657755376702478792668427871420432598708263819042042424981956308827963350940334207728064781636406554522001841051768455663616543189689496408629097463575558558244587741547774513020401181132044615694845592492332629139288606734602582095294885050292351879873095400971733
    s = "My reddit username is 'ThisMonkeyBytes'"
    '''
    string = string_to_val(s)
    enc = rsa_encrypt(string,e,n)
    msg = rsa_decrypt(enc, d, n)
    message = val_to_string_natural(msg)
    print(message)
    '''
    enc = rsa_encrypt_string(s, e, n)
    message = rsa_decrypt_string(enc, d, n)
    
if __name__ == "__main__":
    main()
